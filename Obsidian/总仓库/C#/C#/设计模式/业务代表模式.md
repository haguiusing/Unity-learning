## 业务代表模式
业务代表模式（Business Delegate Pattern）用于对<font color="#ffff00">表示层</font>和<font color="#ffff00">业务层</font>解耦。它基本上是用来减少通信或对表示层代码中的业务层代码的远程查询功能。在业务层中我们有以下实体。
- **客户端（Client）** - 表示层代码可以是 JSP、servlet 或 UI java 代码。
- **业务代表（Business Delegate）** - 一个为客户端实体提供的入口类，它提供了对业务服务方法的访问。
- **查询服务（LookUp Service）** - 查找服务对象负责获取相关的业务实现，并提供业务对象对业务代表对象的访问。
- **业务服务（Business Service）** - 业务服务接口。实现了该业务服务的实体类，提供了实际的业务实现逻辑。

模式结构：
- Business Delegate Interface：业务代表接口
- Business Delegate Implementation：业务代表实现
- Business Service：业务服务
- Presentation Layer：示表层
- Business Logic Layer：业务逻辑层

包含的几个主要角色
- **业务代表接口（Business Delegate Interface）**：
    - 声明访问业务逻辑的方法。
- **业务代表实现（Business Delegate Implementation）**：
    - 实现业务代表接口，封装对业务服务的调用。
- **业务服务（Business Service）**：
    - 业务逻辑层的接口或类，包含实际的业务操作。
- **表示层（Presentation Layer）**：
    - 应用程序的前端，通过业务代表访问业务逻辑。
- **业务逻辑层（Business Logic Layer）**：
    - 包含应用程序的核心业务逻辑。

![[business.svg]]

1. `IBusinessService` 接口：业务服务接口，定义了业务服务的基本方法
2. `EJBService` 和 `JMSService` 类：具体业务服务实现，实现了 `IBusinessService` 接口
3. `BusinessLookUp` 类：业务查询类，负责根据请求返回具体的业务服务实例
4. `BusinessDelegate` 类：业务代表类，作为客户端和业务服务之间的中间层，根据请求类型选择合适的业务服务
5. `Client` 类：客户类，代表客户端，通过业务代表来调用业务服务
6. `BusinessDelegatePatternDemo` 类：演示类，用于演示业务代表模式的使用
   
```cs
using System;

// Business Service：业务服务接口
public interface IBusinessService
{
    void DoProcessing();
}

// Business Service Implementation：业务服务实现
// EJBService类
public class EJBService : IBusinessService
{
    public void DoProcessing()
    {
        Console.WriteLine("Processing task by invoking EJB Service");
    }
}

// JMSService类
public class JMSService : IBusinessService
{
    public void DoProcessing()
    {
        Console.WriteLine("Processing task by invoking JMS Service");
    }
}

// Business LookUp：业务查询
public class BusinessLookUp
{
    public IBusinessService GetBusinessService(string serviceType)
    {
        if (serviceType.Equals("EJB", StringComparison.OrdinalIgnoreCase))
        {
            return new EJBService();
        }
        else
        {
            return new JMSService();
        }
    }
}

// Business Delegate：业务代表
public class BusinessDelegate
{
    private BusinessLookUp lookupService = new BusinessLookUp();
    private IBusinessService businessService;
    private string serviceType;

    public string ServiceType
    {
        set { serviceType = value; }
    }

    public void DoTask()
    {
        businessService = lookupService.GetBusinessService(serviceType);
        businessService.DoProcessing();
    }
}

// Client：客户类
public class Client
{
    private BusinessDelegate businessService;

    public Client(BusinessDelegate businessService)
    {
        this.businessService = businessService;
    }

    public void DoTask()
    {
        businessService.DoTask();
    }
}

// Business Delegate Pattern Demo：业务代表模式演示
public class BusinessDelegatePatternDemo
{
    public static void Main(string[] args)
    {
        BusinessDelegate businessDelegate = new BusinessDelegate();
        businessDelegate.ServiceType = "EJB";

        Client client = new Client(businessDelegate);
        client.DoTask();

        businessDelegate.ServiceType = "JMS";
        client.DoTask();
    }
}
```

执行该程序后，输出结果：
```cs
Processing task by invoking EJB Service
Processing task by invoking JMS Service
```