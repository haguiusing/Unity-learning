[自动布局组件](file://assets/Scripts/UGUI/Lesson24_%E8%87%AA%E5%8A%A8%E5%B8%83%E5%B1%80%E7%BB%84%E4%BB%B6/Lesson24_%E8%87%AA%E5%8A%A8%E5%B8%83%E5%B1%80%E7%BB%84%E4%BB%B6.cs)
# 布局元素 (Layout Element)
如果要覆盖布局元素的最小大小、偏好大小或灵活大小，可通过向游戏对象添加布局元素组件来实现。

布局控制器按以下顺序为布局元素分配宽度或高度：
- 首先，布局控制器将分配最小大小属性（**Min Width**、**Min Height**）。
- 如果有足够的可用空间，布局控制器将分配偏好大小属性（**Preferred Width**、**Preferred Height**）。
- 如果有额外的可用空间，布局控制器将分配灵活大小属性（**Flexible Width**、**Flexible Height**）。

有关最小宽度、偏好宽度和灵活大小的详细信息，请访问[自动布局](https://docs.unity3d.com/cn/2023.2/Manual/UIAutoLayout.html)文档。

## 属性

![](https://docs.unity3d.com/cn/2023.2/uploads/Main/UI_LayoutElementInspector.png)
启用宽度或高度属性时，属性旁边将显示一个值字段。使用此值字段可输入宽度或高度的具体值。**Min** 和 **Preferred** 大小采用常规单位，而 **Flexible** 大小采用相对单位。

|**_属性：_**|**_功能：_**|
|---|---|
|**Ignore Layout**|启用后，布局系统将忽略此布局元素。|
|**Min Width**|此布局元素应具有的最小宽度。|
|**Min Height**|此布局元素应具有的最小高度。|
|**Preferred Width**|在分配额外可用宽度之前，此布局元素应具有的偏好宽度。|
|**Preferred Height**|在分配额外可用高度之前，此布局元素应具有的偏好高度。|
|**Flexible Width**|此布局元素应相对于其同级而填充的额外可用宽度的相对量。|
|**Flexible Height**|此布局元素应相对于其同级而填充的额外可用高度的相对量。|
|**Layout Priority**|此组件的布局优先级。  <br>  <br>如果一个游戏对象有一个以上包含布局属性的组件（例如，一个 Image 组件和一个 LayoutElement 组件），则布局系统将使用 **Layout Priority** 值最高的组件中的属性值。  <br>  <br>如果这些组件具有相同的 **Layout Priority** 值，则布局系统将使用每个属性的最大值，而不管该属性来自哪个组件。|

## 描述
使用布局元素组件可以覆盖一个或多个布局属性的值。启用要覆盖的属性的复选框，然后指定要用于覆盖的值。

最小大小和偏好大小以常规单位定义，而灵活大小以相对单位定义。如果任何布局元素的灵活大小大于零，则意味着将填充所有可用空间。同级的相对灵活大小值决定了每个同级填充的可用空间的比例。最常见的情况是，灵活宽度和高度仅设置为 0 或 1。

在某些情况下，同时指定偏好大小和灵活大小是有意义的。仅在完全分配所有偏好大小后才分配灵活大小。因此，指定了灵活大小但未指定偏好大小的布局元素将保持其最小大小，直到其他布局元素已扩展到完整偏好大小为止，仅在此后才基于额外的可用空间开始扩展。通过同时指定灵活大小，可以避免这种情况，元素可与具有偏好大小的其他布局元素一起扩展到偏好大小，然后在分配完所有灵活大小后进一步扩展。

# 内容大小适配器 (Content Size Fitter)

## 属性
![](https://docs.unity3d.com/cn/2023.2/uploads/Main/UI_ContentSizeFitterInspector.png)

|**_属性：_**|**_功能：_**|
|---|---|
|**Horizontal Fit**|如何控制宽度。|
|Unconstrained|不根据布局元素伸展宽度。|
|Min Size|根据布局元素的最小宽度来伸展宽度。|
|Preferred Size|根据布局元素的偏好宽度来伸展宽度。|
|**Vertical Fit**|如何控制高度。|
|Unconstrained|不根据布局元素伸展高度。|
|Min Size|根据布局元素的最小高度来伸展高度。|
|Preferred Size|根据布局元素的偏好高度来伸展高度。|

## 描述
内容大小适配器充当布局控制器，可用于控制其自身布局元素的大小。大小由游戏对象上布局元素组件提供的最小大小或偏好大小确定。此类布局元素可以是图像或文本组件、布局组或布局元素组件。

值得注意的是，当调整矩形变换的大小时（无论是通过内容大小适配器还是其他工具），大小调整是围绕轴心进行的。这意味着可使用轴心来控制大小调整的方向。

例如，当轴心位于中心位置时，内容大小适配器将在所有方向朝外均匀扩展矩形变换。当轴心位于左上角时，内容大小适配器将向右下方向扩展矩形变换。

# 宽高比适配器 (Aspect Ratio Fitter)

## 属性
![](https://docs.unity3d.com/cn/2023.2/uploads/Main/UI_AspectRatioFitterInspector.png)

|**_属性：_**|**_功能：_**|
|---|---|
|**Aspect Mode**|如何调整矩形的大小来强制实施宽高比。|
|**None**|不让矩形适应宽高比。|
|**Width Controls Height**|根据宽度自动调整高度。|
|**Height Controls Width**|根据高度自动调整宽度。|
|**Fit In Parent**|自动调整宽度、高度、位置和锚点，使矩形适应父项的矩形，同时保持宽高比。父矩形中可能有一些空间不会由此矩形覆盖。|
|**Envelope Parent**|自动调整宽度、高度、位置和锚点，使矩形覆盖父项的整个区域，同时保持宽高比。此矩形可能比父矩形延伸更广。|
|**Aspect Ratio**|要强制实施的宽高比。这是宽度除以高度的比值。|

## 描述
宽高比适配器充当布局控制器，可用于控制其自身布局元素的大小。宽高比适配器可以调整高度来适应宽度或反之，也可以使元素在其父项内部适应或包裹其父项。宽高比适配器不考虑布局信息，例如最小大小和偏好大小。

值得注意的是，当调整矩形变换的大小时（无论是通过宽高比适配器还是其他工具），大小调整是围绕轴心进行的。这意味着可使用轴心来控制矩形的对齐。例如，位于顶部中央位置的轴心将使矩形均匀延伸到两侧，并仅向下延伸，同时保持顶部边缘位置不变。

# 水平布局组 (Horizontal Layout Group)
水平布局组组件将其子布局元素并排放置在一起。子布局元素的宽度根据以下规则由各自的最小宽度、偏好宽度和灵活宽度决定：
- 所有子布局元素的最小宽度相加，并加上它们之间的间距。得到的结果便是水平布局组的最小宽度。
- 所有子布局元素的偏好宽度相加，并加上它们之间的间距。得到的结果便是水平布局组的偏好宽度。
- 如果水平布局组处于其最小宽度或更小值，则所有子布局元素也将具有最小宽度。
- 水平布局组越接近其偏好宽度，每个子布局元素也越接近偏好宽度。
- 如果水平布局组宽度大于其偏好宽度，则会根据各子布局元素的灵活宽度按比例为子布局元素分配额外的可用空间。

有关最小宽度、偏好宽度和灵活宽度的详细信息，请访问[自动布局](https://docs.unity3d.com/cn/2023.2/Manual/UIAutoLayout.html)文档。

## 属性
![](https://docs.unity3d.com/cn/2023.2/uploads/Main/UI_HorizontalLayoutGroupInspector.png)

|**_属性：_**|**_功能：_**|
|---|---|
|**Padding**|布局组边缘内的填充。|
|**Spacing**|布局元素之间的间距。|
|**Child Alignment**|用于子布局元素的对齐方式（如果这些元素未填满可用空间）。|
|**Control Child Size**|布局组是否控制其子布局元素的宽度和高度。|
|**Use Child Scale**|在为元素调整大小和进行布局时，布局组是否考虑其子布局元素的缩放。  <br>  <br>**Width** 和 **Height** 对应于每个子布局元素的 [Rect Transform](https://docs.unity3d.com/cn/2023.2/Manual/class-RectTransform.html) 组件中的 **Scale > X** 和 **Scale > Y** 值。|
|**Child Force Expand**|是否要强制子布局元素扩展以填充额外的可用空间。|

# 垂直布局组 (Vertical Layout Group)
垂直布局组组件将子布局元素纵向放置。子布局元素的高度根据以下规则由各自的最小高度、偏好高度和灵活高度决定：
- 所有子布局元素的最小高度相加，并加上它们之间的间距。得到的结果便是垂直布局组的最小高度。
- 所有子布局元素的偏好高度相加，并加上它们之间的间距。得到的结果便是垂直布局组的偏好高度。
- 如果垂直布局组处于其最小高度或更小值，则所有子布局元素也将具有最小高度。
- 垂直布局组越接近其偏好高度，每个子布局元素也越接近偏好高度。
- 如果垂直布局组高度大于其偏好高度，则会根据各子布局元素的灵活高度按比例为子布局元素分配额外的可用空间。

有关最小宽度、偏好宽度和灵活高度的详细信息，请访问[自动布局](https://docs.unity3d.com/cn/2023.2/Manual/UIAutoLayout.html)文档。

## 属性
![](https://docs.unity3d.com/cn/2023.2/uploads/Main/UI_VerticalLayoutGroupInspector.png)

|**_属性：_**|**_功能：_**|
|---|---|
|**Padding**|布局组边缘内的填充。|
|**Spacing**|布局元素之间的间距。|
|**Child Alignment**|用于子布局元素的对齐方式（如果这些元素未填满可用空间）。|
|**Control Child Size**|布局组是否控制其子布局元素的宽度和高度。|
|**Use Child Scale**|在为元素调整大小和进行布局时，布局组是否考虑其子布局元素的缩放。  <br>  <br>**Width** 和 **Height** 对应于每个子布局元素的 [Rect Transform](https://docs.unity3d.com/cn/2023.2/Manual/class-RectTransform.html) 组件中的 **Scale > X** 和 **Scale > Y** 值。|
|**Child Force Expand**|是否要强制子布局元素扩展以填充额外的可用空间。|

# 网格布局组 (Grid Layout Group)
网格布局组组件将其子布局元素放在网格中。
![](https://docs.unity3d.com/cn/2023.2/uploads/Main/UI_GridLayoutGroupInspector.png)

## 属性

|**_属性：_**|**_功能：_**|
|---|---|
|**Padding**|布局组边缘内的填充。|
|**Cell Size**|要用于组内每个布局元素的大小。|
|**Spacing**|布局元素之间的间距。|
|**Start Corner**|第一个元素所在的角。|
|**Start Axis**|沿哪个主轴放置元素。Horizontal 将在填充整行后才开始新行。Vertical 将在填充整列后才开始新列。|
|**Child Alignment**|用于布局元素的对齐方式（如果这些元素未填满可用空间）。|
|**Constraint**|将网格约束为固定数量的行或列以便支持自动布局系统。|

## 描述
与其他布局组不同，网格布局组会忽略其包含的布局元素的最小大小、偏好大小和灵活大小属性，而是为所有这些元素分配固定大小，此大小则由网格布局组本身的 Cell Size 属性进行定义。

### 网格布局组和自动布局
将网格布局组用作自动布局设置的一部分（例如将其与[内容大小适配器 (Content Size Fitter)](https://docs.unity3d.com/cn/2023.2/Manual/script-ContentSizeFitter.html) 一起使用）时，需要注意一些特殊注意事项。

自动布局系统会独立计算水平和垂直大小。这一点可能与网格布局组不一致；网格布局组的行数取决于列数或反之。

对于任何给定数量的单元格，行数和列数的不同组合可以使网格适应其内容。为了支持布局系统，可使用 Constraint 属性指定希望该表具有固定列数或行数。

建议按照以下方法将布局系统与内容大小适配器结合使用：

#### 灵活宽度和固定高度
要设置具有灵活宽度和固定高度的网格，从而使网格随着添加的元素增多而水平扩展，可设置如下属性：
- Grid Layout Group Constraint：Fixed Row Count
- Content Size Fitter Horizontal Fit：Preferred Size
- Content Size Fitter Vertical Fit：Preferred Size 或 Unconstrained

如果 Vertical Fit 设置为 Unconstrained，则由您为网格提供足够大的高度来适应指定的单元格行数。

#### 固定宽度和灵活高度
要设置具有固定宽度和灵活高度的网格，从而使网格随着添加的元素增多而垂直扩展，可设置如下属性：
- Grid Layout Group Constraint：Fixed Column Count
- Content Size Fitter Horizontal Fit：Preferred Size 或 Unconstrained
- Content Size Fitter Vertical Fit：Preferred Size

如果 Horizontal Fit 设置为 Unconstrained，则由您为网格提供足够大的宽度来适应指定的单元格列数。

#### 灵活宽度和灵活高度
如果希望网格同时具有灵活宽度和灵活高度，这是可以的，但无法控制具体的行数和列数。网格将尝试使行数和列数大致相同。可设置如下属性：
- Grid Layout Group Constraint：Flexible
- Content Size Fitter Horizontal Fit：Preferred Size
- Content Size Fitter Vertical Fit：Preferred Size