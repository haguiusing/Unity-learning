/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => LinkPreviewPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  mySetting: "default",
  previewDelay: 50,
  enablePreview: true,
  maxPreviewHeight: 400,
  maxPreviewWidth: 600
};
var LinkPreviewPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    // Track active preview elements by link URL
    this.activeLinks = /* @__PURE__ */ new Map();
  }
  async onload() {
    await this.loadSettings();
    this.registerDomEvent(document, "mouseover", (evt) => {
      const target = evt.target;
      const linkEl = target.closest("a");
      if (!linkEl || !this.settings.enablePreview)
        return;
      if (linkEl.hasClass("external-link")) {
        const rect = linkEl.getBoundingClientRect();
        this.showPreview(linkEl, rect);
      }
    });
    this.addSettingTab(new LinkPreviewSettingTab(this.app, this));
  }
  /**
   * Clean up any remaining previews when plugin is disabled
   */
  onunload() {
    this.activeLinks.forEach((previewEl, linkId) => {
      previewEl.remove();
    });
    this.activeLinks.clear();
  }
  /**
   * Creates and shows a preview window for a link element
   * @param linkEl - The link element for which to create a preview
   * @param rect - The bounding rectangle of the link element
   */
  showPreview(linkEl, rect) {
    const url = linkEl.getAttribute("href");
    if (!url)
      return;
    const linkId = `preview-${url}`;
    if (this.activeLinks.has(linkId))
      return;
    const hoverEl = this.createPreviewElement(rect);
    const loadingEl = hoverEl.createDiv({ cls: "preview-loading" });
    loadingEl.setText("Loading preview...");
    const iframeWrapper = hoverEl.createDiv({ cls: "preview-iframe-wrapper" });
    const iframe = iframeWrapper.createEl("iframe", {
      attr: {
        src: url,
        style: "display: none; width: 100%; height: 100%; border: none;"
      }
    });
    iframe.addEventListener("load", () => {
      loadingEl.remove();
      iframe.style.display = "block";
    });
    iframe.addEventListener("error", () => {
      loadingEl.setText("Failed to load preview");
    });
    const cleanup = () => {
      this.activeLinks.delete(linkId);
      hoverEl.remove();
      linkEl.removeAttribute("data-preview-active");
    };
    let isLinkHovered = true;
    let isPreviewHovered = false;
    const removePreview = () => {
      if (!isLinkHovered && !isPreviewHovered) {
        cleanup();
      }
    };
    const handleLinkEnter = () => {
      isLinkHovered = true;
    };
    const handleLinkLeave = () => {
      isLinkHovered = false;
      setTimeout(removePreview, 100);
    };
    const handlePreviewEnter = () => {
      isPreviewHovered = true;
    };
    const handlePreviewLeave = () => {
      isPreviewHovered = false;
      removePreview();
    };
    linkEl.addEventListener("mouseenter", handleLinkEnter);
    linkEl.addEventListener("mouseleave", handleLinkLeave);
    hoverEl.addEventListener("mouseenter", handlePreviewEnter);
    hoverEl.addEventListener("mouseleave", handlePreviewLeave);
    this.activeLinks.set(linkId, hoverEl);
    document.body.appendChild(hoverEl);
  }
  /**
   * Creates the preview container element with proper positioning
   * @param rect - The bounding rectangle used for positioning
   * @returns HTMLElement configured as preview container
   */
  createPreviewElement(rect) {
    return createEl("div", {
      cls: "hover-popup",
      attr: {
        style: `
                    position: fixed;
                    left: ${rect.left}px;
                    top: ${rect.bottom + 5}px;
                    z-index: 1000;
                    width: ${this.settings.maxPreviewWidth}px;
                    height: ${this.settings.maxPreviewHeight}px;
                `
      }
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var LinkPreviewSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Enable preview").setDesc("Toggle link preview functionality").addToggle((toggle) => toggle.setValue(this.plugin.settings.enablePreview).onChange(async (value) => {
      this.plugin.settings.enablePreview = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Preview delay").setDesc("How long to wait before showing the preview (in milliseconds)").addText((text) => text.setPlaceholder("300").setValue(String(this.plugin.settings.previewDelay)).onChange(async (value) => {
      this.plugin.settings.previewDelay = Number(value);
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Maximum preview height").setDesc("Maximum height of the preview window (in pixels)").addText((text) => text.setPlaceholder("300").setValue(String(this.plugin.settings.maxPreviewHeight)).onChange(async (value) => {
      this.plugin.settings.maxPreviewHeight = Number(value);
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Maximum preview width").setDesc("Maximum width of the preview window (in pixels)").addText((text) => text.setPlaceholder("400").setValue(String(this.plugin.settings.maxPreviewWidth)).onChange(async (value) => {
      this.plugin.settings.maxPreviewWidth = Number(value);
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5cbi8qKlxuICogU2V0dGluZ3MgaW50ZXJmYWNlIGZvciB0aGUgTGluayBQcmV2aWV3IHBsdWdpblxuICovXG5pbnRlcmZhY2UgTGlua1ByZXZpZXdTZXR0aW5ncyB7XG4gICAgbXlTZXR0aW5nOiBzdHJpbmc7XG4gICAgcHJldmlld0RlbGF5OiBudW1iZXI7XG4gICAgbWF4UHJldmlld0hlaWdodDogbnVtYmVyO1xuICAgIGVuYWJsZVByZXZpZXc6IGJvb2xlYW47XG4gICAgbWF4UHJldmlld1dpZHRoOiBudW1iZXI7XG59XG5cbi8vIERlZmF1bHQgc2V0dGluZ3MgdmFsdWVzXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBMaW5rUHJldmlld1NldHRpbmdzID0ge1xuICAgIG15U2V0dGluZzogJ2RlZmF1bHQnLFxuICAgIHByZXZpZXdEZWxheTogNTAsXG4gICAgZW5hYmxlUHJldmlldzogdHJ1ZSxcbiAgICBtYXhQcmV2aWV3SGVpZ2h0OiA0MDAsXG4gICAgbWF4UHJldmlld1dpZHRoOiA2MDBcbn1cblxuLyoqXG4gKiBMaW5rIFByZXZpZXcgcGx1Z2luIHRoYXQgc2hvd3MgaWZyYW1lIHByZXZpZXdzIG9mIGV4dGVybmFsIGxpbmtzIG9uIGhvdmVyXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExpbmtQcmV2aWV3UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogTGlua1ByZXZpZXdTZXR0aW5ncztcbiAgICAvLyBUcmFjayBhY3RpdmUgcHJldmlldyBlbGVtZW50cyBieSBsaW5rIFVSTFxuICAgIHByaXZhdGUgYWN0aXZlTGlua3M6IE1hcDxzdHJpbmcsIEhUTUxFbGVtZW50PiA9IG5ldyBNYXAoKTtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgICAgICAvLyBSZWdpc3RlciB0aGUgaG92ZXIgaGFuZGxlciB3aXRoIGNsZWFudXBcbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnbW91c2VvdmVyJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZ0LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IGxpbmtFbCA9IHRhcmdldC5jbG9zZXN0KCdhJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghbGlua0VsIHx8ICF0aGlzLnNldHRpbmdzLmVuYWJsZVByZXZpZXcpIHJldHVybjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGxpbmtFbC5oYXNDbGFzcygnZXh0ZXJuYWwtbGluaycpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVjdCA9IGxpbmtFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dQcmV2aWV3KGxpbmtFbCwgcmVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTGlua1ByZXZpZXdTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgYW55IHJlbWFpbmluZyBwcmV2aWV3cyB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxuICAgICAqL1xuICAgIG9udW5sb2FkKCkge1xuICAgICAgICAvLyBDbGVhbiB1cCBhbnkgcmVtYWluaW5nIHByZXZpZXdzXG4gICAgICAgIHRoaXMuYWN0aXZlTGlua3MuZm9yRWFjaCgocHJldmlld0VsLCBsaW5rSWQpID0+IHtcbiAgICAgICAgICAgIHByZXZpZXdFbC5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYWN0aXZlTGlua3MuY2xlYXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBzaG93cyBhIHByZXZpZXcgd2luZG93IGZvciBhIGxpbmsgZWxlbWVudFxuICAgICAqIEBwYXJhbSBsaW5rRWwgLSBUaGUgbGluayBlbGVtZW50IGZvciB3aGljaCB0byBjcmVhdGUgYSBwcmV2aWV3XG4gICAgICogQHBhcmFtIHJlY3QgLSBUaGUgYm91bmRpbmcgcmVjdGFuZ2xlIG9mIHRoZSBsaW5rIGVsZW1lbnRcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dQcmV2aWV3KGxpbmtFbDogSFRNTEVsZW1lbnQsIHJlY3Q6IERPTVJlY3QpIHtcbiAgICAgICAgY29uc3QgdXJsID0gbGlua0VsLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICAgICAgICBpZiAoIXVybCkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGxpbmtJZCA9IGBwcmV2aWV3LSR7dXJsfWA7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZUxpbmtzLmhhcyhsaW5rSWQpKSByZXR1cm47XG5cbiAgICAgICAgLy8gQ3JlYXRlIGhvdmVyIGVsZW1lbnQgdXNpbmcgY3JlYXRlRWwgZm9yIHNlY3VyaXR5XG4gICAgICAgIGNvbnN0IGhvdmVyRWwgPSB0aGlzLmNyZWF0ZVByZXZpZXdFbGVtZW50KHJlY3QpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGxvYWRpbmcgaW5kaWNhdG9yIHNhZmVseVxuICAgICAgICBjb25zdCBsb2FkaW5nRWwgPSBob3ZlckVsLmNyZWF0ZURpdih7Y2xzOiAncHJldmlldy1sb2FkaW5nJ30pO1xuICAgICAgICBsb2FkaW5nRWwuc2V0VGV4dCgnTG9hZGluZyBwcmV2aWV3Li4uJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgaWZyYW1lIHdyYXBwZXIgYW5kIGlmcmFtZSBzYWZlbHlcbiAgICAgICAgY29uc3QgaWZyYW1lV3JhcHBlciA9IGhvdmVyRWwuY3JlYXRlRGl2KHtjbHM6ICdwcmV2aWV3LWlmcmFtZS13cmFwcGVyJ30pO1xuICAgICAgICBjb25zdCBpZnJhbWUgPSBpZnJhbWVXcmFwcGVyLmNyZWF0ZUVsKCdpZnJhbWUnLCB7XG4gICAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICAgICAgc3JjOiB1cmwsXG4gICAgICAgICAgICAgICAgc3R5bGU6ICdkaXNwbGF5OiBub25lOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBib3JkZXI6IG5vbmU7J1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgbG9hZCBldmVudCBoYW5kbGVyIGJlZm9yZSBhZGRpbmcgaWZyYW1lIHRvIERPTVxuICAgICAgICBpZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgICAgIGxvYWRpbmdFbC5yZW1vdmUoKTtcbiAgICAgICAgICAgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICAgICAgbG9hZGluZ0VsLnNldFRleHQoJ0ZhaWxlZCB0byBsb2FkIHByZXZpZXcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2V0IHVwIGV2ZW50IGhhbmRsZXJzXG4gICAgICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUxpbmtzLmRlbGV0ZShsaW5rSWQpO1xuICAgICAgICAgICAgaG92ZXJFbC5yZW1vdmUoKTtcbiAgICAgICAgICAgIGxpbmtFbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtcHJldmlldy1hY3RpdmUnKTtcbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgaXNMaW5rSG92ZXJlZCA9IHRydWU7XG4gICAgICAgIGxldCBpc1ByZXZpZXdIb3ZlcmVkID0gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgcmVtb3ZlUHJldmlldyA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICghaXNMaW5rSG92ZXJlZCAmJiAhaXNQcmV2aWV3SG92ZXJlZCkge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoYW5kbGVMaW5rRW50ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBpc0xpbmtIb3ZlcmVkID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoYW5kbGVMaW5rTGVhdmUgPSAoKSA9PiB7XG4gICAgICAgICAgICBpc0xpbmtIb3ZlcmVkID0gZmFsc2U7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJlbW92ZVByZXZpZXcsIDEwMCk7IC8vIFNtYWxsIGRlbGF5IHRvIGFsbG93IG1vdmluZyB0byBwcmV2aWV3XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgaGFuZGxlUHJldmlld0VudGVyID0gKCkgPT4ge1xuICAgICAgICAgICAgaXNQcmV2aWV3SG92ZXJlZCA9IHRydWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgaGFuZGxlUHJldmlld0xlYXZlID0gKCkgPT4ge1xuICAgICAgICAgICAgaXNQcmV2aWV3SG92ZXJlZCA9IGZhbHNlO1xuICAgICAgICAgICAgcmVtb3ZlUHJldmlldygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgbGlua0VsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBoYW5kbGVMaW5rRW50ZXIpO1xuICAgICAgICBsaW5rRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGhhbmRsZUxpbmtMZWF2ZSk7XG4gICAgICAgIGhvdmVyRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGhhbmRsZVByZXZpZXdFbnRlcik7XG4gICAgICAgIGhvdmVyRWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGhhbmRsZVByZXZpZXdMZWF2ZSk7XG5cbiAgICAgICAgdGhpcy5hY3RpdmVMaW5rcy5zZXQobGlua0lkLCBob3ZlckVsKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChob3ZlckVsKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIHRoZSBwcmV2aWV3IGNvbnRhaW5lciBlbGVtZW50IHdpdGggcHJvcGVyIHBvc2l0aW9uaW5nXG4gICAgICogQHBhcmFtIHJlY3QgLSBUaGUgYm91bmRpbmcgcmVjdGFuZ2xlIHVzZWQgZm9yIHBvc2l0aW9uaW5nXG4gICAgICogQHJldHVybnMgSFRNTEVsZW1lbnQgY29uZmlndXJlZCBhcyBwcmV2aWV3IGNvbnRhaW5lclxuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlUHJldmlld0VsZW1lbnQocmVjdDogRE9NUmVjdCk6IEhUTUxFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUVsKCdkaXYnLCB7XG4gICAgICAgICAgICBjbHM6ICdob3Zlci1wb3B1cCcsXG4gICAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICAgICAgc3R5bGU6IGBcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgICAgICAgICAgICAgICBsZWZ0OiAke3JlY3QubGVmdH1weDtcbiAgICAgICAgICAgICAgICAgICAgdG9wOiAke3JlY3QuYm90dG9tICsgNX1weDtcbiAgICAgICAgICAgICAgICAgICAgei1pbmRleDogMTAwMDtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICR7dGhpcy5zZXR0aW5ncy5tYXhQcmV2aWV3V2lkdGh9cHg7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogJHt0aGlzLnNldHRpbmdzLm1heFByZXZpZXdIZWlnaHR9cHg7XG4gICAgICAgICAgICAgICAgYFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG59XG5cbi8qKlxuICogU2V0dGluZ3MgdGFiIGZvciBjb25maWd1cmluZyB0aGUgTGluayBQcmV2aWV3IHBsdWdpblxuICovXG5jbGFzcyBMaW5rUHJldmlld1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IExpbmtQcmV2aWV3UGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTGlua1ByZXZpZXdQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBwcmV2aWV3JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUb2dnbGUgbGluayBwcmV2aWV3IGZ1bmN0aW9uYWxpdHknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVByZXZpZXcpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVQcmV2aWV3ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdQcmV2aWV3IGRlbGF5JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdIb3cgbG9uZyB0byB3YWl0IGJlZm9yZSBzaG93aW5nIHRoZSBwcmV2aWV3IChpbiBtaWxsaXNlY29uZHMpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMzAwJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXZpZXdEZWxheSkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmV2aWV3RGVsYXkgPSBOdW1iZXIodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnTWF4aW11bSBwcmV2aWV3IGhlaWdodCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnTWF4aW11bSBoZWlnaHQgb2YgdGhlIHByZXZpZXcgd2luZG93IChpbiBwaXhlbHMpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMzAwJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heFByZXZpZXdIZWlnaHQpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4UHJldmlld0hlaWdodCA9IE51bWJlcih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdNYXhpbXVtIHByZXZpZXcgd2lkdGgnKVxuICAgICAgICAgICAgLnNldERlc2MoJ01heGltdW0gd2lkdGggb2YgdGhlIHByZXZpZXcgd2luZG93IChpbiBwaXhlbHMpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignNDAwJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heFByZXZpZXdXaWR0aCkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhQcmV2aWV3V2lkdGggPSBOdW1iZXIodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUF1RDtBQWN2RCxJQUFNLG1CQUF3QztBQUFBLEVBQzFDLFdBQVc7QUFBQSxFQUNYLGNBQWM7QUFBQSxFQUNkLGVBQWU7QUFBQSxFQUNmLGtCQUFrQjtBQUFBLEVBQ2xCLGlCQUFpQjtBQUNyQjtBQUtBLElBQXFCLG9CQUFyQixjQUErQyx1QkFBTztBQUFBLEVBQXREO0FBQUE7QUFHSTtBQUFBLFNBQVEsY0FBd0Msb0JBQUksSUFBSTtBQUFBO0FBQUEsRUFFeEQsTUFBTSxTQUFTO0FBQ1gsVUFBTSxLQUFLLGFBQWE7QUFHeEIsU0FBSyxpQkFBaUIsVUFBVSxhQUFhLENBQUMsUUFBb0I7QUFDOUQsWUFBTSxTQUFTLElBQUk7QUFDbkIsWUFBTSxTQUFTLE9BQU8sUUFBUSxHQUFHO0FBRWpDLFVBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxTQUFTO0FBQWU7QUFFN0MsVUFBSSxPQUFPLFNBQVMsZUFBZSxHQUFHO0FBQ2xDLGNBQU0sT0FBTyxPQUFPLHNCQUFzQjtBQUMxQyxhQUFLLFlBQVksUUFBUSxJQUFJO0FBQUEsTUFDakM7QUFBQSxJQUNKLENBQUM7QUFFRCxTQUFLLGNBQWMsSUFBSSxzQkFBc0IsS0FBSyxLQUFLLElBQUksQ0FBQztBQUFBLEVBQ2hFO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFLQSxXQUFXO0FBRVAsU0FBSyxZQUFZLFFBQVEsQ0FBQyxXQUFXLFdBQVc7QUFDNUMsZ0JBQVUsT0FBTztBQUFBLElBQ3JCLENBQUM7QUFDRCxTQUFLLFlBQVksTUFBTTtBQUFBLEVBQzNCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT1EsWUFBWSxRQUFxQixNQUFlO0FBQ3BELFVBQU0sTUFBTSxPQUFPLGFBQWEsTUFBTTtBQUN0QyxRQUFJLENBQUM7QUFBSztBQUVWLFVBQU0sU0FBUyxXQUFXO0FBQzFCLFFBQUksS0FBSyxZQUFZLElBQUksTUFBTTtBQUFHO0FBR2xDLFVBQU0sVUFBVSxLQUFLLHFCQUFxQixJQUFJO0FBRzlDLFVBQU0sWUFBWSxRQUFRLFVBQVUsRUFBQyxLQUFLLGtCQUFpQixDQUFDO0FBQzVELGNBQVUsUUFBUSxvQkFBb0I7QUFHdEMsVUFBTSxnQkFBZ0IsUUFBUSxVQUFVLEVBQUMsS0FBSyx5QkFBd0IsQ0FBQztBQUN2RSxVQUFNLFNBQVMsY0FBYyxTQUFTLFVBQVU7QUFBQSxNQUM1QyxNQUFNO0FBQUEsUUFDRixLQUFLO0FBQUEsUUFDTCxPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0osQ0FBQztBQUdELFdBQU8saUJBQWlCLFFBQVEsTUFBTTtBQUNsQyxnQkFBVSxPQUFPO0FBQ2pCLGFBQU8sTUFBTSxVQUFVO0FBQUEsSUFDM0IsQ0FBQztBQUVELFdBQU8saUJBQWlCLFNBQVMsTUFBTTtBQUNuQyxnQkFBVSxRQUFRLHdCQUF3QjtBQUFBLElBQzlDLENBQUM7QUFHRCxVQUFNLFVBQVUsTUFBTTtBQUNsQixXQUFLLFlBQVksT0FBTyxNQUFNO0FBQzlCLGNBQVEsT0FBTztBQUNmLGFBQU8sZ0JBQWdCLHFCQUFxQjtBQUFBLElBQ2hEO0FBRUEsUUFBSSxnQkFBZ0I7QUFDcEIsUUFBSSxtQkFBbUI7QUFFdkIsVUFBTSxnQkFBZ0IsTUFBTTtBQUN4QixVQUFJLENBQUMsaUJBQWlCLENBQUMsa0JBQWtCO0FBQ3JDLGdCQUFRO0FBQUEsTUFDWjtBQUFBLElBQ0o7QUFFQSxVQUFNLGtCQUFrQixNQUFNO0FBQzFCLHNCQUFnQjtBQUFBLElBQ3BCO0FBRUEsVUFBTSxrQkFBa0IsTUFBTTtBQUMxQixzQkFBZ0I7QUFDaEIsaUJBQVcsZUFBZSxHQUFHO0FBQUEsSUFDakM7QUFFQSxVQUFNLHFCQUFxQixNQUFNO0FBQzdCLHlCQUFtQjtBQUFBLElBQ3ZCO0FBRUEsVUFBTSxxQkFBcUIsTUFBTTtBQUM3Qix5QkFBbUI7QUFDbkIsb0JBQWM7QUFBQSxJQUNsQjtBQUdBLFdBQU8saUJBQWlCLGNBQWMsZUFBZTtBQUNyRCxXQUFPLGlCQUFpQixjQUFjLGVBQWU7QUFDckQsWUFBUSxpQkFBaUIsY0FBYyxrQkFBa0I7QUFDekQsWUFBUSxpQkFBaUIsY0FBYyxrQkFBa0I7QUFFekQsU0FBSyxZQUFZLElBQUksUUFBUSxPQUFPO0FBQ3BDLGFBQVMsS0FBSyxZQUFZLE9BQU87QUFBQSxFQUNyQztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9RLHFCQUFxQixNQUE0QjtBQUNyRCxXQUFPLFNBQVMsT0FBTztBQUFBLE1BQ25CLEtBQUs7QUFBQSxNQUNMLE1BQU07QUFBQSxRQUNGLE9BQU87QUFBQTtBQUFBLDRCQUVLLEtBQUs7QUFBQSwyQkFDTixLQUFLLFNBQVM7QUFBQTtBQUFBLDZCQUVaLEtBQUssU0FBUztBQUFBLDhCQUNiLEtBQUssU0FBUztBQUFBO0FBQUEsTUFFaEM7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDakIsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFBQSxFQUM3RTtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUFBLEVBQ3JDO0FBQ0o7QUFLQSxJQUFNLHdCQUFOLGNBQW9DLGlDQUFpQjtBQUFBLEVBR2pELFlBQVksS0FBVSxRQUEyQjtBQUM3QyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNsQjtBQUFBLEVBRUEsVUFBZ0I7QUFDWixVQUFNLEVBQUMsWUFBVyxJQUFJO0FBRXRCLGdCQUFZLE1BQU07QUFFbEIsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsZ0JBQWdCLEVBQ3hCLFFBQVEsbUNBQW1DLEVBQzNDLFVBQVUsWUFBVSxPQUNoQixTQUFTLEtBQUssT0FBTyxTQUFTLGFBQWEsRUFDM0MsU0FBUyxPQUFPLFVBQVU7QUFDdkIsV0FBSyxPQUFPLFNBQVMsZ0JBQWdCO0FBQ3JDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSxlQUFlLEVBQ3ZCLFFBQVEsK0RBQStELEVBQ3ZFLFFBQVEsVUFBUSxLQUNaLGVBQWUsS0FBSyxFQUNwQixTQUFTLE9BQU8sS0FBSyxPQUFPLFNBQVMsWUFBWSxDQUFDLEVBQ2xELFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLGVBQWUsT0FBTyxLQUFLO0FBQ2hELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSx3QkFBd0IsRUFDaEMsUUFBUSxrREFBa0QsRUFDMUQsUUFBUSxVQUFRLEtBQ1osZUFBZSxLQUFLLEVBQ3BCLFNBQVMsT0FBTyxLQUFLLE9BQU8sU0FBUyxnQkFBZ0IsQ0FBQyxFQUN0RCxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxtQkFBbUIsT0FBTyxLQUFLO0FBQ3BELFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSx1QkFBdUIsRUFDL0IsUUFBUSxpREFBaUQsRUFDekQsUUFBUSxVQUFRLEtBQ1osZUFBZSxLQUFLLEVBQ3BCLFNBQVMsT0FBTyxLQUFLLE9BQU8sU0FBUyxlQUFlLENBQUMsRUFDckQsU0FBUyxPQUFPLFVBQVU7QUFDdkIsV0FBSyxPQUFPLFNBQVMsa0JBQWtCLE9BQU8sS0FBSztBQUNuRCxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDbkMsQ0FBQyxDQUFDO0FBQUEsRUFDZDtBQUNKOyIsCiAgIm5hbWVzIjogW10KfQo=
