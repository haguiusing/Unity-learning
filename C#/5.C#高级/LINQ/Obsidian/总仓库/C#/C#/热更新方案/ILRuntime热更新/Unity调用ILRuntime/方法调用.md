## 静态方法调用
![[Lesson5.cs]]
静态方法调用有两种方式:
1 .直接通过appdomain.Invoke("命名空间.类名", "静态方法名", null, 参数列表)
	调用静态方法(不需要传入调用它的对象所以instance为null)
2 .通过类似反射的IMethod调用方法
	  通过IType中的GetMethod方法，类似反射一样的获取对应类中的方法
		2-1.通过appdomain.Invoke（IMethod对象, null, 参数列表）
		2-2.通过更节约性能的无GC Alloc方式（调用完后直接回收）调用，类似上节课的成员属性
```CS
using (var method = appDomain.BeginInvoke(methodName))
{
      method.Push.....(1000);//传入指定类型参数
      method.Invoke();//执行方法
      method.Read....()//获取指定类型返回值
}
```

## 成员方法调用
![[Lesson6.cs]]
成员方法调用和静态方法调用几乎一样
区别就是需要先创建对象，将对象传入之前为null的地方
1.直接通过appdomain.Invoke("命名空间.类名", "方法名", 类对象, 参数列表)
2.通过类似反射的IMethod调用方法
  通过IType中的GetMethod方法，类似反射一样的获取对应类中的方法
  2-1.通过appdomain.Invoke（IMethod对象, 类对象, 参数列表）
  2-2.通过更节约性能的GC Alloc方式（调用完后直接回收）调用，类似上节课的成员属性

## 重载方法调用
![[Lesson7.cs]]
1.参数数量不同
1-1.通过appDomain.Invoke调用参数数量不同格式，传入参数即可自动分别
1-2.通过GetMethod的第二个参数来获取对应参数个数的函数

2.参数数量相同，类型不同，通过上面两种方式直接使用无法确定取出来的函数是谁
  我们需要通过GetMethod方法来获取指定参数类型的函数
  2.1-获取参数对应的IType类型，利用appDomain中的GetType方法 获取指定变量类型的IType
  2.2-放入参数列表中，将获取到的IType放入List\<IType>中
  2.3-传入GetMethod中获取指定类型参数，使用GetMethod的另一个重载，传入指定类型获取方法信息

## ref/out方法调用

需要通过IMethod方法调用
并且需要使用无GC Alloc方法调用

1.和其他函数不一样的地方
需要先压入ref或out参数的初始值

2.和其它函数调用写法一致
压入调用对象
压入各参数

3.ref和out因为在一开始就压入了值
在这里需要压入他们的索引位置
ref和out参数 压入参数引用索引值即可 从0开始

4.通过Read按顺序获取ref/out参数的值 和返回值，返回值最后获取
