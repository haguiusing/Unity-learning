
![[Pasted image 20240924225426.png]]
![[Pasted image 20240924225448.png]]

# Animation 选项卡

__动画剪辑__是 Unity 动画的最小构成元素。它们代表了一个单独的运动，例如 RunLeft、Jump 或 Crawl，并且可通过各种方式进行操作和组合，从而产生生动的效果（请参阅[动画状态机 (Animation State Machines)](https://docs.unity3d.com/cn/current/Manual/AnimationStateMachines.html)、[Animator Controller](https://docs.unity3d.com/cn/current/Manual/class-AnimatorController.html) 或[混合树 (Blend Trees)](https://docs.unity3d.com/cn/current/Manual/class-BlendTree.html)）。 您可以从导入的 FBX 数据中选择动画剪辑。

单击包含动画剪辑的模型时，将显示以下属性：
![动画剪辑检视面板 (Animation Clip Inspector)](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-Inspector.png)
动画剪辑检视面板 (Animation Clip Inspector)

There are five areas on the **Animation** tab of the Inspector window:

**(A)** [特定资源属性](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#AssetProperties)。这些设置定义了整个资源的导入选项。
**(B)** [剪辑选择列表](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#ClipSelectionList)。您可以从此列表中选择任何项目以显示其属性并预览其动画。您也可以[定义新的剪辑](https://docs.unity3d.com/cn/current/Manual/Splittinganimations.html)。
**(C)** [特定剪辑属性](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#ClipProperties)。这些设置定义了所选__动画剪辑__的导入选项。
**(D)** [剪辑属性](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#AllClipProperties)。这些设置定义所有动画剪辑的导入选项。
**(E)** [动画预览](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#AnimationPreview)。您可以在此处播放动画并选择特定帧。

## 特定于资源的属性

![整个资源的导入选项](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-Inspector_Asset.png)
整个资源的导入选项

这些属性适用于此资源中定义的所有动画剪辑和约束：

| **属性：**                          |                                        | **功能：**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -------------------------------- | -------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Import Constraints**           |                                        | 从此资源导入[约束](https://docs.unity3d.com/cn/current/Manual/Constraints.html)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Import Animation**             |                                        | 从此资源导入动画。  <br>  <br>**_注意：_**如果禁用此选项，则会隐藏此页面上的所有其他选项，并且不会导入任何动画。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Bake Animations**              |                                        | 烘焙通过反向动力学 (IK) 或模拟 (Simulation) 创建的动画以便推进运动关键帧。  <br>  <br>仅可用于 Autodesk® Maya®、Autodesk® 3ds Max® 和 Cinema 4D 文件。                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Resample Curves**              |                                        | 将动画曲线重新采样为 Quaternion 值，并为动画中的每一帧生成新的 Quaternion 关键帧。  <br>  <br>仅当导入文件包含 Euler 曲线时，才会显示此选项。默认情况下，此选项处于启用状态。  <br>  <br>禁用此选项可[保持动画曲线最初创作的状态](https://docs.unity3d.com/cn/current/Manual/AnimationEulerCurveImport.html)。仅当与原始动画相比，重新采样的动画中存在插值问题时，才应禁用此选项。                                                                                                                                                                                                                                                                                                    |
| **Anim. Compression**            |                                        | 导入动画时要使用的压缩类型。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                                  | **Off**                                | 禁用动画压缩。这意味着 Unity 不会在导入时减少关键帧数量。禁用动画压缩可产生最高精度的动画，但性能会降低、文件会更大、运行时内存大小将增加。通常建议不要使用此选项；如果需要更高精度的动画，应启用关键帧减少 (Keyframe Reduction) 功能并减小允许的 **Animation Compression Error** 值。                                                                                                                                                                                                                                                                                                                                                                                     |
|                                  | **Keyframe Reduction**                 | 减少导入时的冗余关键帧。如果启用，Inspector 将显示 **Animation Compression Errors** 选项。这会影响文件大小 （运行时内存） 和曲线的计算方式。  <br>  <br>适用于 **Legacy**、**Generic** 和 **Humanoid** [Animation Type](https://docs.unity3d.com/cn/current/Manual/FBXImporter-Rig.html) 装备。                                                                                                                                                                                                                                                                                                                       |
|                                  | **Keyframe Reduction and Compression** | 导入时减少关键帧并在文件中存储动画时压缩关键帧。这仅影响文件大小；运行时内存大小与 **Keyframe Reduction** 相同。如果启用此属性，则 Inspector 会显示 **Animation Compression Errors** 选项。  <br>  <br>仅适用于 **Legacy** [动画类型](https://docs.unity3d.com/cn/current/Manual/FBXImporter-Rig.html)绑定。                                                                                                                                                                                                                                                                                                                         |
|                                  | **Optimal**                            | 让 Unity 决定如何进行压缩：通过减少关键帧还是通过使用密集格式。如果启用此属性，则 Inspector 会显示 **Animation Compression Errors** 选项。  <br>  <br>仅适用于 **Generic** 和 **Humanoid** [动画类型](https://docs.unity3d.com/cn/current/Manual/FBXImporter-Rig.html)绑定。                                                                                                                                                                                                                                                                                                                                          |
| **Animation Compression Errors** |                                        | 仅当启用 **Keyframe Reduction** 或 **Optimal** 压缩时可用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|                                  | **Rotation Error**                     | 设置旋转曲线压缩的容错度（以度为单位的角度）。Unity 使用此值来确定是否可以删除旋转曲线上的关键点。  <br>  <br>这表示原始旋转值和减小值之间的最小角度：  <br>  <br>`Angle(value, reduced) < RotationError`                                                                                                                                                                                                                                                                                                                                                                                                                        |
|                                  | **Position Error**                     | 设置位置曲线压缩的容错度（百分比）。Unity 使用此值来确定是否可以删除位置曲线上的关键点。有关更多信息，请参阅[设置容错度以减少位置曲线和缩放曲线上的关键点](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#tolerance)。                                                                                                                                                                                                                                                                                                                                                                                              |
|                                  | **Scale Error**                        | 设置缩放曲线压缩的容错度（百分比）。Unity 使用此值来确定是否可以删除缩放曲线上的关键点。有关更多信息，请参阅[设置容错度以减少位置曲线和缩放曲线上的关键点](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#tolerance)。                                                                                                                                                                                                                                                                                                                                                                                              |
| **Animated Custom Properties**   |                                        | 导入您指定为自定义用户属性的任何 FBX 属性，一般对应DCC工具中的extraUserProperties字段中定义的数据。  <br>  <br>Unity 在导入 FBX 文件时仅支持一小部分属性（例如转换、旋转、缩放和可见性）。但是，您可以借助 [extraUserProperties](https://docs.unity3d.com/cn/current/ScriptReference/ModelImporter-extraUserProperties.html) 成员，在导入器脚本中指定标准 FBX 属性（如用户属性）来处理这些属性。在导入期间，Unity 会将所有这些指定属性传递给[资源后处理器 (Asset postprocessor)](https://docs.unity3d.com/cn/current/ScriptReference/AssetPostprocessor.OnPostprocessGameObjectWithUserProperties.html)，就像“真实”用户属性一样。                                                                              |
| **Remove Constant Scale Curves** |                                        | FBX transform堆栈包括可用于偏移旋转和[缩放变换](https://zhida.zhihu.com/search?content_id=209320984&content_type=Article&match_order=1&q=%E7%BC%A9%E6%94%BE%E5%8F%98%E6%8D%A2&zhida_source=entity)的变换枢轴。 当导入FBX内容到Unity时，[transforms](https://zhida.zhihu.com/search?content_id=209320984&content_type=Article&match_order=1&q=transforms&zhida_source=entity)和animations被转换成一个更简单的转换栈，这个操作可以创建额外的[动画曲线](https://zhida.zhihu.com/search?content_id=209320984&content_type=Article&match_order=1&q=%E5%8A%A8%E7%94%BB%E6%9B%B2%E7%BA%BF&zhida_source=entity)。 启用此属性以删除不必要的缩放曲线。 |

### 设置容错度以减少位置曲线和缩放曲线上的关键点

通过设置容错度百分比，确定 Unity 是否可以删除位置曲线或缩放曲线上的关键点作为动画压缩策略。

将 **Anim. Compression** 属性设置为“Keyframe Reduction”或“Optimal”时，Unity 会将原始曲线与删除特定关键帧后的曲线外观进行比较，并应用以下测试：

```
OriginalValue - ReducedValue > OriginalValue * percentageOfError
```

如果原始值和消减值之间的差值小于原始值乘以容错度百分比，则 Unity 会删除关键帧。

请注意，Unity 会比较三个曲线分量之间的距离（即，它会比较 `distance(x,y,z)`）以及每个分量的距离（`distance(x)`，`distance(y)`，然后是 `distance(z)`）。

以下示例说明了 Unity 如何使用 10% 的容错度来估算 y 轴上的减少量：
![在 y 轴上移动的简单动画中将位置误差定义为 10%](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-tolerance_Ex1.png)
在 y 轴上移动的简单动画中将位置误差定义为 10%

关键帧 A 的值为 11.2：
![关键帧 A 的值为 11.2](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-tolerance_Ex2.png)
关键帧 A 的值为 11.2

关键帧 B 的值为 11.1：
![关键帧 B 的值为 11.1](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-tolerance_Ex3.png)
关键帧 B 的值为 11.1

所得的消减曲线如下所示：
![所得的消减曲线](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-tolerance_Ex4.png)
所得的消减曲线

**关键帧 A 未被消减**，原因是：

- 原始值与消减值之间的距离为 `D = 11.2 - 10 = 1.2`。
- 误差幅度为 `E = 10% * 11.2 = 1.12`
- **D > E**

**关键帧 B 被消减**，原因是 `11.1 - 10 < 10% * 11.1`：

- 原始值与消减值之间的距离为 `D = 11.1 - 10 = 1.11`
- 误差幅度为 `E = 10% * 11.1 = 1.11`
- **D = E**

请注意，当使用仅略有变化的较高值时，此方法有局限性。将场景移开 1000 个单位会产生基本上相同的动画，但位置会远离 0。

![小幅变化的较高值](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-tolerance_Ex5.png)
小幅变化的较高值

在这种情况下，两个关键帧都会被消减。

**关键帧 A 被消减**，原因是：

- 原始值与消减值之间的距离为 `D = 1011.2 - 1010 = 1.2`
- 误差幅度为 `E = 10% * 1011.2 = 101.12`

**关键帧 B 被消减**，原因是 `11.1 - 10 < 10% * 11.1`：

- 原始值与消减值之间的距离为 `D = 11.1 - 10 = 1.11`
- 误差幅度为 `E = 10% * 1011.1 = 101.11`

较高的值要求原始值与消减值之间的差值要大得多才能将关键帧保留在消减曲线中。关键帧 A 的值为 1100，将被丢弃；关键帧 B 的值为 1112，将被保留：

![较高的值需要更大的差值](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-tolerance_Ex6.png)
较高的值需要更大的差值

## 剪辑选择列表

![此文件中定义的剪辑列表](https://docs.unity3d.com/cn/current/uploads/Main/classAnimationClip-Inspector_Selection.png)
此文件中定义的剪辑列表

在 **Animation** 选项卡的此区域中可执行以下任务：

- 从列表中选择一个剪辑以[显示特定于剪辑的属性](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#ClipProperties)。
- 在[剪辑预览面板](https://docs.unity3d.com/cn/current/Manual/class-AnimationClip.html#AnimationPreview)中播放所选剪辑。
- 使用添加 (`+`) 按钮为此文件[创建新剪辑](https://docs.unity3d.com/cn/current/Manual/Splittinganimations.html)。
- 使用删除 (`-`) 按钮删除所选的剪辑定义。

**警告：**如果您手动更改导入的剪辑的任何属性，则当源资源更改时，Unity 不会导入新的动画剪辑。例如，如果在 **Animation** 选项卡上创建新剪辑或更改剪辑的时间，则即使在 Unity 之外将剪辑添加到 FBX 文件中，该剪辑列表也不会更改。Unity 将忽略新的动画剪辑。

